// Traducciones para OLES
const translations = {
  es: {
    // Navegación
    nav: {
      inicio: "Inicio",
      acerca: "Acerca del Observatorio",
      mision: "Misión",
      equipo: "Equipo",
      investigacion: "Investigación",
      estudios: "Estudios",
      todosEstudios: "Todos los Estudios",
      encuestas: "Encuestas",
      cualitativos: "Cualitativos",
      prensaRedes: "Prensa y Redes",
      datosAdmin: "Datos Administrativos",
      publicaciones: "Publicaciones Académicas",
      eventos: "Eventos",
      noticias: "Noticias",
      contacto: "Contacto",
      volverEstudios: "← Volver a Estudios",
      volverNoticias: "← Volver a Noticias",
      irInicio: "Ir al Inicio →",
      verEstudios: "Ver estudios →",
      verMas: "Ver más →",
      verEquipo: "Ver perfiles completos →",
      masNoticias: "Más noticias →",
      verTodas: "Ver todas →"
    },
    // Secciones
    secciones: {
      destacados: "Destacados",
      noticiasRecientes: "Noticias Recientes",
      estudios: "Nuestras Líneas de Investigación",
      todosEstudios: "Todos los Estudios",
      agenda: "Agenda",
      equipo: "Nuestro Equipo",
      direccion: "Dirección",
      investigadores: "Investigadores",
      asistentes: "Asistentes de Investigación",
      acerca: "Acerca del Observatorio",
      publicaciones: "Publicaciones Académicas"
    },
    // Hero
    hero: {
      titulo: "Observatorio de Legitimidad",
      subtitulo: "Investigación sobre legitimidad institucional en Chile"
    },
    // Estudios
    estudios: {
      titulo: "Nuestros Estudios de Investigación",
      intro: "Listado completo de todas nuestras investigaciones activas y finalizadas, organizadas por línea de investigación.",
      encuestas: {
        titulo: "Estudios de Encuesta",
        descripcion: "Investigaciones basadas en encuestas representativas que analizan percepciones y actitudes sobre legitimidad institucional."
      },
      cualitativos: {
        titulo: "Estudios Cualitativos",
        descripcion: "Investigaciones cualitativas que profundizan en las experiencias y narrativas sobre legitimidad institucional."
      },
      prensa: {
        titulo: "Estudios de Prensa y Redes Sociales",
        descripcion: "Análisis de contenido de medios de comunicación y redes sociales sobre legitimidad y confianza institucional."
      },
      datos: {
        titulo: "Estudios de Datos Administrativos",
        descripcion: "Análisis de datos administrativos y estadísticos para comprender patrones de legitimidad institucional."
      },
      estado: "Estado",
      estudio: "Estudio",
      periodo: "Período",
      enCurso: "En curso",
      finalizado: "Finalizado"
    },
    // Noticias
    noticias: {
      titulo: "Noticias",
      descripcion: "Últimas noticias y novedades del Observatorio de Legitimidad.",
      volver: "← Volver a Noticias"
    },
    // Equipo
    equipo: {
      titulo: "Nuestro Equipo",
      descripcion: "Conoce a los investigadores del Observatorio de Legitimidad.",
      verPerfil: "Ver perfil completo"
    },
    // Acerca
    acerca: {
      descripcion: "El Observatorio de Legitimidad (OLES) es un centro de investigación dedicado al estudio de la legitimidad institucional en Chile.",
      parrafo1: "Nuestro objetivo es generar conocimiento riguroso y de calidad sobre cómo los ciudadanos perciben y evalúan las instituciones públicas, con especial énfasis en las instituciones de seguridad y justicia.",
      parrafo2: "A través de nuestras líneas de investigación, buscamos contribuir al debate público y a la formulación de políticas que fortalezcan la legitimidad democrática."
    },
    // Footer
    footer: {
      enlaces: "Enlaces",
      investigacion: "Investigación",
      derechos: "© 2024 OLES - Observatorio de Legitimidad. Todos los derechos reservados."
    },
    // Común
    comun: {
      leerMas: "Leer más",
      verDetalles: "Ver detalles",
      descargar: "Descargar",
      compartir: "Compartir"
    }
  },
  en: {
    // Navigation
    nav: {
      inicio: "Home",
      acerca: "About the Observatory",
      mision: "Mission",
      equipo: "Team",
      investigacion: "Research",
      estudios: "Studies",
      todosEstudios: "All Studies",
      encuestas: "Surveys",
      cualitativos: "Qualitative",
      prensaRedes: "Press & Social Media",
      datosAdmin: "Administrative Data",
      publicaciones: "Academic Publications",
      eventos: "Events",
      noticias: "News",
      contacto: "Contact",
      volverEstudios: "← Back to Studies",
      volverNoticias: "← Back to News",
      irInicio: "Go to Home →",
      verEstudios: "View studies →",
      verMas: "View more →",
      verEquipo: "View full profiles →",
      masNoticias: "More news →",
      verTodas: "View all →"
    },
    // Sections
    secciones: {
      destacados: "Highlights",
      noticiasRecientes: "Recent News",
      estudios: "Our Research Lines",
      todosEstudios: "All Studies",
      agenda: "Upcoming Events",
      equipo: "Our Team",
      direccion: "Direction",
      investigadores: "Researchers",
      asistentes: "Research Assistants",
      acerca: "About the Observatory",
      publicaciones: "Academic Publications"
    },
    // Hero
    hero: {
      titulo: "Legitimacy Observatory",
      subtitulo: "Research on institutional legitimacy in Chile"
    },
    // Studies
    estudios: {
      titulo: "Our Research Studies",
      intro: "Complete list of all our active and completed research, organized by research line.",
      encuestas: {
        titulo: "Survey Studies",
        descripcion: "Research based on representative surveys that analyze perceptions and attitudes about institutional legitimacy."
      },
      cualitativos: {
        titulo: "Qualitative Studies",
        descripcion: "Qualitative research that delves into experiences and narratives about institutional legitimacy."
      },
      prensa: {
        titulo: "Press and Social Media Studies",
        descripcion: "Content analysis of media and social networks on legitimacy and institutional trust."
      },
      datos: {
        titulo: "Administrative Data Studies",
        descripcion: "Analysis of administrative and statistical data to understand patterns of institutional legitimacy."
      },
      estado: "Status",
      estudio: "Study",
      periodo: "Period",
      enCurso: "Ongoing",
      finalizado: "Completed"
    },
    // News
    noticias: {
      titulo: "News",
      descripcion: "Latest news and updates from the Legitimacy Observatory.",
      volver: "← Back to News"
    },
    // Team
    equipo: {
      titulo: "Our Team",
      descripcion: "Meet the researchers of the Legitimacy Observatory.",
      verPerfil: "View full profile"
    },
    // About
    acerca: {
      descripcion: "The Legitimacy Observatory (OLES) is a research center dedicated to the study of institutional legitimacy in Chile.",
      parrafo1: "Our goal is to generate rigorous and quality knowledge about how citizens perceive and evaluate public institutions, with special emphasis on security and justice institutions.",
      parrafo2: "Through our research lines, we seek to contribute to public debate and the formulation of policies that strengthen democratic legitimacy."
    },
    // Footer
    footer: {
      enlaces: "Links",
      investigacion: "Research",
      derechos: "© 2024 OLES - Legitimacy Observatory. All rights reserved."
    },
    // Common
    comun: {
      leerMas: "Read more",
      verDetalles: "View details",
      descargar: "Download",
      compartir: "Share"
    }
  }
};

// Función para obtener traducción
function t(key, lang = 'es') {
  const keys = key.split('.');
  let value = translations[lang];
  
  for (const k of keys) {
    if (value && typeof value === 'object' && k in value) {
      value = value[k];
    } else {
      return key;
    }
  }
  
  return value;
}

// Función para cambiar idioma
function changeLanguage(lang) {
  currentLang = lang;
  localStorage.setItem('olesLanguage', lang);
  
  document.documentElement.lang = lang;
  
  document.querySelectorAll('.language-btn').forEach(btn => {
    btn.classList.remove('active');
    if (btn.getAttribute('data-lang') === lang) {
      btn.classList.add('active');
    }
  });
  
  document.querySelectorAll('[data-i18n]').forEach(element => {
    const key = element.getAttribute('data-i18n');
    const translation = t(key, lang);
    
    if (translation && translation !== key) {
      if (element.tagName === 'INPUT' && element.getAttribute('placeholder')) {
        element.placeholder = translation;
      } else if (element.tagName === 'IMG') {
        element.alt = translation;
      } else if (element.hasAttribute('title')) {
        element.title = translation;
      } else {
        element.textContent = translation;
      }
    }
  });
}

let currentLang = 'es';

document.addEventListener('DOMContentLoaded', function() {
  const savedLang = localStorage.getItem('olesLanguage') || 'es';
  changeLanguage(savedLang);
  
  document.querySelectorAll('.language-btn').forEach(btn => {
    btn.addEventListener('click', function() {
      const lang = this.getAttribute('data-lang');
      changeLanguage(lang);
    });
  });
});
