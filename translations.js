// Sistema de traducciones - OLES
const translations = {
    es: {
        // NavegaciÃ³n
        nav: {
            inicio: "Inicio",
            acerca: "Acerca del Observatorio",
            mision: "MisiÃ³n",
            equipo: "Equipo",
            investigacion: "InvestigaciÃ³n",
            estudios: "Estudios",
            todosEstudios: "ðŸ“‹ Todos los Estudios",
            encuestas: "ðŸ“Š Encuestas",
            cualitativos: "ðŸŽ™ï¸ Cualitativos",
            prensaRedes: "ðŸ“° Prensa y Redes",
            datosAdmin: "ðŸ“ˆ Datos Administrativos",
            proyectos: "Proyectos",
            publicaciones: "ðŸ“š Publicaciones AcadÃ©micas",
            tesis: "Tesis y PrÃ¡cticas",
            noticias: "Noticias",
            eventos: "Eventos",
            repositorio: "Repositorio",
            datos: "Datos",
            contacto: "Contacto",
            verTodas: "Ver todas â†’",
            verMas: "Ver mÃ¡s â†’",
            verEstudios: "Todos los estudios â†’"
        },
        // Secciones
        secciones: {
            destacados: "Destacados",
            noticiasRecientes: "Noticias Recientes",
            estudios: "Nuestras LÃ­neas de InvestigaciÃ³n",
            proyectos: "Proyectos",
            todosProyectos: "Todos los proyectos",
            agenda: "Agenda",
            verMas: "Ver mÃ¡s",
            acerca: "Acerca del Observatorio",
            mision: "MisiÃ³n",
            vision: "VisiÃ³n",
            equipo: "Equipo",
            direccion: "DirecciÃ³n",
            subdireccion: "SubdirecciÃ³n",
            verMasEquipo: "Ver mÃ¡s del equipo â†’"
        },
        // Equipo
        equipo: {
            directora: "Directora",
            director: "Director",
            subdirectora: "Subdirectora",
            subdirector: "Subdirector",
            direccion: "DirecciÃ³n",
            subdirectores: "SubdirecciÃ³n",
            investigadores: "Investigadores Asociados",
            coordinador: "Asistente Coordinador",
            asistentes: "Asistentes de InvestigaciÃ³n",
            verTesistas: "Tesistas y Pasantes",
            tesistasDescripcion: "Estudiantes que desarrollan sus tesis e investigaciones en el marco del Observatorio.",
            verTesistasBtn: "Ver Tesistas y Pasantes â†’"
        },
        // Tipos
        tipos: {
            noticia: "Noticia",
            evento: "Evento",
            publicacion: "PublicaciÃ³n"
        },
        // Contenido
        contenido: {
            mision: "El Observatorio de Legitimidad tiene como misiÃ³n generar conocimiento cientÃ­fico de calidad sobre la legitimidad institucional en Chile, contribuyendo al debate pÃºblico y a la formulaciÃ³n de polÃ­ticas basadas en evidencia.",
            vision: "Ser un referente nacional e internacional en la investigaciÃ³n sobre legitimidad institucional, desigualdades y cohesiÃ³n social, promoviendo el diÃ¡logo entre la academia, la sociedad civil y los tomadores de decisiÃ³n.",
            verProyectos: "Ver proyectos",
            titulo: "Observatorio de Legitimidad"
        },
        // Estudios
        estudios: {
            titulo: "Nuestros Estudios de InvestigaciÃ³n",
            intro: "Listado completo de todas nuestras investigaciones activas y finalizadas.",
            encuestas: {
                titulo: "ðŸ“Š Estudios de Encuesta",
                descripcion: "Investigaciones basadas en encuestas representativas que analizan percepciones y actitudes sobre legitimidad institucional."
            },
            cualitativos: {
                titulo: "ðŸŽ™ï¸ Estudios Cualitativos",
                descripcion: "Investigaciones cualitativas que profundizan en las experiencias y narrativas sobre legitimidad institucional."
            },
            prensa: {
                titulo: "ðŸ“° Estudios de Prensa y Redes Sociales",
                descripcion: "AnÃ¡lisis de contenido de medios de comunicaciÃ³n y redes sociales sobre legitimidad y confianza institucional."
            },
            datos: {
                titulo: "ðŸ“ˆ Estudios de Datos Administrativos",
                descripcion: "AnÃ¡lisis de datos administrativos y estadÃ­sticos para comprender patrones de legitimidad institucional."
            }
        },
        // Acerca
        acerca: {
            descripcion: "El Observatorio de Legitimidad (OLES) es un centro de investigaciÃ³n dedicado al estudio de la legitimidad institucional en Chile.",
            parrafo1: "Nuestro objetivo es generar conocimiento riguroso y de calidad sobre cÃ³mo los ciudadanos perciben y evalÃºan las instituciones pÃºblicas.",
            parrafo2: "A travÃ©s de nuestras lÃ­neas de investigaciÃ³n, buscamos contribuir al debate pÃºblico y a la formulaciÃ³n de polÃ­ticas que fortalezcan la legitimidad democrÃ¡tica."
        },
        // Footer
        footer: {
            enlaces: "Enlaces",
            contacto: "Contacto",
            investigacion: "InvestigaciÃ³n",
            derechos: "Â© 2025 Observatorio de Legitimidad. Todos los derechos reservados."
        }
    },
    en: {
        // Navigation
        nav: {
            inicio: "Home",
            acerca: "About the Observatory",
            mision: "Mission",
            equipo: "Team",
            investigacion: "Research",
            estudios: "Studies",
            todosEstudios: "ðŸ“‹ All Studies",
            encuestas: "ðŸ“Š Surveys",
            cualitativos: "ðŸŽ™ï¸ Qualitative",
            prensaRedes: "ðŸ“° Press & Social Media",
            datosAdmin: "ðŸ“ˆ Administrative Data",
            proyectos: "Projects",
            publicaciones: "ðŸ“š Academic Publications",
            tesis: "Thesis and Internships",
            noticias: "News",
            eventos: "Events",
            repositorio: "Repository",
            datos: "Data",
            contacto: "Contact",
            verTodas: "View all â†’",
            verMas: "View more â†’",
            verEstudios: "All studies â†’"
        },
        // Sections
        secciones: {
            destacados: "Featured",
            noticiasRecientes: "Recent News",
            estudios: "Our Research Lines",
            proyectos: "Projects",
            todosProyectos: "All projects",
            agenda: "Agenda",
            verMas: "See more",
            acerca: "About the Observatory",
            mision: "Mission",
            vision: "Vision",
            equipo: "Team",
            direccion: "Direction",
            subdireccion: "Subdirection",
            verMasEquipo: "See more of the team â†’"
        },
        // Team
        equipo: {
            directora: "Director",
            director: "Director",
            subdirectora: "Associate Director",
            subdirector: "Associate Director",
            direccion: "Direction",
            subdirectores: "Associate Directors",
            investigadores: "Associate Researchers",
            coordinador: "Coordinator Assistant",
            asistentes: "Research Assistants",
            verTesistas: "Thesis Students & Interns",
            tesistasDescripcion: "Students developing their theses and research within the Observatory.",
            verTesistasBtn: "View Thesis Students & Interns â†’"
        },
        // Types
        tipos: {
            noticia: "News",
            evento: "Event",
            publicacion: "Publication"
        },
        // Content
        contenido: {
            mision: "The Legitimacy Observatory's mission is to generate high-quality scientific knowledge about institutional legitimacy in Chile, contributing to public debate and evidence-based policy formulation.",
            vision: "To be a national and international reference in research on institutional legitimacy, inequalities and social cohesion, promoting dialogue between academia, civil society and decision-makers.",
            verProyectos: "View projects",
            titulo: "Legitimacy Observatory"
        },
        // Studies
        estudios: {
            titulo: "Our Research Studies",
            intro: "Complete list of all our active and completed research.",
            encuestas: {
                titulo: "ðŸ“Š Survey Studies",
                descripcion: "Research based on representative surveys that analyze perceptions and attitudes about institutional legitimacy."
            },
            cualitativos: {
                titulo: "ðŸŽ™ï¸ Qualitative Studies",
                descripcion: "Qualitative research that delves into experiences and narratives about institutional legitimacy."
            },
            prensa: {
                titulo: "ðŸ“° Press and Social Media Studies",
                descripcion: "Content analysis of media and social networks on institutional legitimacy and trust."
            },
            datos: {
                titulo: "ðŸ“ˆ Administrative Data Studies",
                descripcion: "Analysis of administrative and statistical data to understand patterns of institutional legitimacy."
            }
        },
        // About
        acerca: {
            descripcion: "The Legitimacy Observatory (OLES) is a research center dedicated to the study of institutional legitimacy in Chile.",
            parrafo1: "Our goal is to generate rigorous and quality knowledge about how citizens perceive and evaluate public institutions.",
            parrafo2: "Through our research lines, we seek to contribute to public debate and the formulation of policies that strengthen democratic legitimacy."
        },
        // Footer
        footer: {
            enlaces: "Links",
            contacto: "Contact",
            investigacion: "Research",
            derechos: "Â© 2025 Legitimacy Observatory. All rights reserved."
        }
    }
};

// Mapeo de textos del navbar a claves de traducciÃ³n
const navbarTranslations = {
    es: {
        'Inicio': 'Inicio',
        'Somos': 'Somos',
        'Noticias': 'Noticias',
        'InvestigaciÃ³n': 'InvestigaciÃ³n',
        'ðŸ“‹ Todos los Estudios': 'ðŸ“‹ Todos los Estudios',
        'ðŸ“Š Encuestas': 'ðŸ“Š Encuestas',
        'ðŸŽ™ï¸ Cualitativos': 'ðŸŽ™ï¸ Cualitativos',
        'ðŸ“° Prensa y Redes': 'ðŸ“° Prensa y Redes',
        'ðŸ“ˆ Datos Administrativos': 'ðŸ“ˆ Datos Administrativos',
        'ðŸ“š Publicaciones AcadÃ©micas': 'ðŸ“š Publicaciones AcadÃ©micas',
        'Eventos': 'Eventos',
        'Equipo': 'Equipo',
        'Contacto': 'Contacto'
    },
    en: {
        'Inicio': 'Home',
        'Somos': 'About Us',
        'Noticias': 'News',
        'InvestigaciÃ³n': 'Research',
        'ðŸ“‹ Todos los Estudios': 'ðŸ“‹ All Studies',
        'ðŸ“Š Encuestas': 'ðŸ“Š Surveys',
        'ðŸŽ™ï¸ Cualitativos': 'ðŸŽ™ï¸ Qualitative',
        'ðŸ“° Prensa y Redes': 'ðŸ“° Press & Social Media',
        'ðŸ“ˆ Datos Administrativos': 'ðŸ“ˆ Administrative Data',
        'ðŸ“š Publicaciones AcadÃ©micas': 'ðŸ“š Academic Publications',
        'Eventos': 'Events',
        'Equipo': 'Team',
        'Contacto': 'Contact'
    }
};

// Textos originales en espaÃ±ol para referencia inversa
const originalTexts = {
    'Home': 'Inicio',
    'News': 'Noticias',
    'Research': 'InvestigaciÃ³n',
    'ðŸ“‹ All Studies': 'ðŸ“‹ Todos los Estudios',
    'ðŸ“Š Surveys': 'ðŸ“Š Encuestas',
    'ðŸŽ™ï¸ Qualitative': 'ðŸŽ™ï¸ Cualitativos',
    'ðŸ“° Press & Social Media': 'ðŸ“° Prensa y Redes',
    'ðŸ“ˆ Administrative Data': 'ðŸ“ˆ Datos Administrativos',
    'ðŸ“š Academic Publications': 'ðŸ“š Publicaciones AcadÃ©micas',
    'Events': 'Eventos',
    'Team': 'Equipo',
    'Contact': 'Contacto'
};

// FunciÃ³n para obtener traducciÃ³n
function t(key, lang = 'es') {
    const keys = key.split('.');
    let value = translations[lang];
    for (const k of keys) {
        value = value?.[k];
    }
    return value || key;
}

// FunciÃ³n para traducir el navbar
function translateNavbar(lang) {
    // Traducir links del navbar
    document.querySelectorAll('.navbar .nav-link .menu-text, .navbar .dropdown-text').forEach(element => {
        const currentText = element.textContent.trim();
        
        // Buscar en espaÃ±ol primero
        if (navbarTranslations.es[currentText]) {
            element.textContent = navbarTranslations[lang][currentText];
        }
        // Si estÃ¡ en inglÃ©s, convertir a espaÃ±ol primero y luego traducir
        else if (originalTexts[currentText]) {
            const spanishText = originalTexts[currentText];
            element.textContent = navbarTranslations[lang][spanishText];
        }
    });
}

// FunciÃ³n para cambiar idioma
function changeLanguage(lang) {
    // Guardar preferencia
    localStorage.setItem('language', lang);
    
    // Actualizar atributo lang del HTML
    document.documentElement.lang = lang;
    
    // Actualizar botones de idioma
    document.querySelectorAll('.language-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.getAttribute('data-lang') === lang) {
            btn.classList.add('active');
        }
    });
    
    // Traducir navbar
    translateNavbar(lang);
    
    // Traducir todos los elementos con data-i18n
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        const translation = t(key, lang);
        
        if (element.tagName === 'TITLE') {
            document.title = translation;
        } else if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
            element.placeholder = translation;
        } else if (element.hasAttribute('data-i18n-html')) {
            element.innerHTML = translation;
        } else {
            element.textContent = translation;
        }
    });
}

// Inicializar idioma al cargar la pÃ¡gina
document.addEventListener('DOMContentLoaded', () => {
    // Siempre iniciar en espaÃ±ol por defecto
    changeLanguage('es');
    
    // Agregar event listeners a los botones de idioma
    document.querySelectorAll('.language-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            const lang = btn.getAttribute('data-lang');
            changeLanguage(lang);
        });
    });
});
